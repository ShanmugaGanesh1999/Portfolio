# Design YouTube

> Video streaming platform with upload and playback

---

## ğŸ“‹ Problem Statement

Design a video sharing and streaming platform like YouTube where users can upload, watch, search, like, and comment on videos.

---

## R - Requirements

### Functional Requirements

```
1. Upload videos
2. Watch/stream videos
3. Search videos
4. Like/dislike videos
5. Comment on videos
6. Subscribe to channels
7. Video recommendations
8. Watch history
```

### Non-Functional Requirements

```
1. High availability (always watchable)
2. Low latency playback start (<2 seconds)
3. Smooth playback (no buffering)
4. Support for various devices/bandwidths
5. Scalable to billions of daily views
```

### Capacity Estimation

```
Users:
â”œâ”€â”€ 2B total users
â”œâ”€â”€ 500M daily active viewers
â”œâ”€â”€ 5M video uploaders

Videos:
â”œâ”€â”€ 500 hours of video uploaded per minute
â”œâ”€â”€ 500 Ã— 60 = 30,000 hours/hour
â”œâ”€â”€ Average video: 10 minutes, 1GB (original)

Views:
â”œâ”€â”€ 5B videos watched per day
â”œâ”€â”€ 5B / 86400 â‰ˆ 60,000 views/second
â”œâ”€â”€ Peak: 600,000 views/second

Storage:
â”œâ”€â”€ 30,000 hours Ã— 1GB = 30PB/day (before encoding)
â”œâ”€â”€ After transcoding (multiple resolutions): 50PB/day
```

---

## H - High-Level Design

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                     CDN Layer                           â”‚â”‚
â”‚   â”‚   (Edge servers worldwide for video delivery)           â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                            â”‚                                 â”‚
â”‚                            â–¼                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                  Load Balancer                          â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â–¼          â–¼              â–¼              â–¼              â–¼ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Uploadâ”‚  â”‚Streamâ”‚    â”‚  Search  â”‚   â”‚  User    â”‚  â”‚Rec. â”‚ â”‚
â”‚ â”‚Serviceâ”‚ â”‚Serviceâ”‚   â”‚  Service â”‚   â”‚ Service  â”‚  â”‚Svc  â”‚ â”‚
â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”˜ â”‚
â”‚    â”‚         â”‚             â”‚              â”‚            â”‚     â”‚
â”‚    â–¼         â”‚             â–¼              â–¼            â–¼     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Transcode â”‚ â”‚      â”‚Elasticsearchâ”‚ â”‚  MySQL  â”‚   â”‚  ML   â”‚ â”‚
â”‚ â”‚ Queue    â”‚ â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ Model â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚       â”‚                                               â”‚
â”‚      â–¼       â–¼                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚                    Storage Layer                          â”‚â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚ â”‚  â”‚   S3    â”‚  â”‚  Cassandra  â”‚  â”‚  Redis  â”‚  â”‚ Metadata â”‚ â”‚â”‚
â”‚ â”‚  â”‚ (Video) â”‚  â”‚ (Comments)  â”‚  â”‚ (Cache) â”‚  â”‚   (SQL)  â”‚ â”‚â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## S - Storage Schema

### Data Models

```
Videos:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ video_id      â”‚ VARCHAR   â”‚ PRIMARY KEY (UUID)              â”‚
â”‚ channel_id    â”‚ BIGINT    â”‚ FK to channels                  â”‚
â”‚ title         â”‚ VARCHAR   â”‚ Searchable                      â”‚
â”‚ description   â”‚ TEXT      â”‚                                 â”‚
â”‚ duration      â”‚ INT       â”‚ Seconds                         â”‚
â”‚ status        â”‚ ENUM      â”‚ processing/live/deleted         â”‚
â”‚ visibility    â”‚ ENUM      â”‚ public/unlisted/private         â”‚
â”‚ upload_date   â”‚ TIMESTAMP â”‚ Indexed                         â”‚
â”‚ view_count    â”‚ BIGINT    â”‚ Denormalized                    â”‚
â”‚ like_count    â”‚ BIGINT    â”‚ Denormalized                    â”‚
â”‚ thumbnail_url â”‚ VARCHAR   â”‚ CDN URL                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Video_Files:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ video_id      â”‚ VARCHAR   â”‚ FK                              â”‚
â”‚ resolution    â”‚ VARCHAR   â”‚ 1080p, 720p, 480p, etc.         â”‚
â”‚ format        â”‚ VARCHAR   â”‚ mp4, webm                       â”‚
â”‚ size_bytes    â”‚ BIGINT    â”‚                                 â”‚
â”‚ url           â”‚ VARCHAR   â”‚ S3/CDN path                     â”‚
â”‚ bitrate       â”‚ INT       â”‚ kbps                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Channels:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ channel_id    â”‚ BIGINT    â”‚ PRIMARY KEY                     â”‚
â”‚ owner_id      â”‚ BIGINT    â”‚ FK to users                     â”‚
â”‚ name          â”‚ VARCHAR   â”‚                                 â”‚
â”‚ description   â”‚ TEXT      â”‚                                 â”‚
â”‚ subscriber_countâ”‚ BIGINT  â”‚ Denormalized                    â”‚
â”‚ created_at    â”‚ TIMESTAMP â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Comments (Cassandra):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ video_id      â”‚ VARCHAR   â”‚ Partition Key                   â”‚
â”‚ comment_id    â”‚ TIMEUUID  â”‚ Clustering Key                  â”‚
â”‚ user_id       â”‚ BIGINT    â”‚                                 â”‚
â”‚ content       â”‚ TEXT      â”‚                                 â”‚
â”‚ parent_id     â”‚ UUID      â”‚ For replies                     â”‚
â”‚ like_count    â”‚ INT       â”‚                                 â”‚
â”‚ created_at    â”‚ TIMESTAMP â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## D - Detailed Design

### Video Upload Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Upload Pipeline                            â”‚
â”‚                                                              â”‚
â”‚   1. User initiates upload                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚  Client  â”‚â”€â”€â”€â”€â–ºâ”‚  Upload Service â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚        â”‚                    â”‚                                â”‚
â”‚        â”‚           Create video record                       â”‚
â”‚        â”‚           Generate presigned URL                    â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚        â”‚                                                     â”‚
â”‚   2. Upload directly to S3                                  â”‚
â”‚        â”‚                                                     â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                                           â”‚   S3    â”‚       â”‚
â”‚   3. S3 event triggers processing         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚
â”‚                                                â”‚             â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚        â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚                Transcoding Pipeline                     â”‚â”‚
â”‚   â”‚                                                         â”‚â”‚
â”‚   â”‚   Original.mp4                                          â”‚â”‚
â”‚   â”‚        â”‚                                                â”‚â”‚
â”‚   â”‚        â”œâ”€â”€â–º 1080p (H.264, H.265)                       â”‚â”‚
â”‚   â”‚        â”œâ”€â”€â–º 720p  (H.264, H.265)                       â”‚â”‚
â”‚   â”‚        â”œâ”€â”€â–º 480p  (H.264)                              â”‚â”‚
â”‚   â”‚        â”œâ”€â”€â–º 360p  (H.264)                              â”‚â”‚
â”‚   â”‚        â””â”€â”€â–º 144p  (mobile)                             â”‚â”‚
â”‚   â”‚                                                         â”‚â”‚
â”‚   â”‚   Also generate:                                        â”‚â”‚
â”‚   â”‚   â”œâ”€â”€ Thumbnails (multiple options)                    â”‚â”‚
â”‚   â”‚   â”œâ”€â”€ Preview sprites                                  â”‚â”‚
â”‚   â”‚   â””â”€â”€ Subtitles (speech-to-text)                       â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚   4. Update video status to "live"                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Transcoding Details

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Transcoding Specifications                     â”‚
â”‚                                                              â”‚
â”‚   Resolution  â”‚ Bitrate   â”‚ Use Case                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   4K (2160p)  â”‚ 20 Mbps   â”‚ Smart TVs, high-end             â”‚
â”‚   1080p       â”‚ 5 Mbps    â”‚ Desktop, good connection        â”‚
â”‚   720p        â”‚ 2.5 Mbps  â”‚ Tablets, average connection     â”‚
â”‚   480p        â”‚ 1 Mbps    â”‚ Mobile, limited bandwidth       â”‚
â”‚   360p        â”‚ 0.5 Mbps  â”‚ Slow connections                â”‚
â”‚   144p        â”‚ 0.1 Mbps  â”‚ Very slow connections           â”‚
â”‚                                                              â”‚
â”‚   Formats:                                                   â”‚
â”‚   â”œâ”€â”€ H.264/AVC: Universal compatibility                   â”‚
â”‚   â”œâ”€â”€ H.265/HEVC: 50% smaller, needs modern devices        â”‚
â”‚   â”œâ”€â”€ VP9: Open source, YouTube uses this                  â”‚
â”‚   â””â”€â”€ AV1: Latest, best compression                        â”‚
â”‚                                                              â”‚
â”‚   Container: .mp4 or .webm                                  â”‚
â”‚   Audio: AAC, Opus                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Adaptive Bitrate Streaming

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Adaptive Bitrate Streaming (HLS/DASH)               â”‚
â”‚                                                              â”‚
â”‚   Video split into segments (2-10 seconds each):            â”‚
â”‚                                                              â”‚
â”‚   video_1080p/                                               â”‚
â”‚   â”œâ”€â”€ segment_001.ts                                        â”‚
â”‚   â”œâ”€â”€ segment_002.ts                                        â”‚
â”‚   â””â”€â”€ segment_003.ts                                        â”‚
â”‚                                                              â”‚
â”‚   video_720p/                                                â”‚
â”‚   â”œâ”€â”€ segment_001.ts                                        â”‚
â”‚   â””â”€â”€ ...                                                   â”‚
â”‚                                                              â”‚
â”‚   Master Playlist (manifest.m3u8):                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ #EXTM3U                                             â”‚   â”‚
â”‚   â”‚ #EXT-X-STREAM-INF:BANDWIDTH=5000000                 â”‚   â”‚
â”‚   â”‚ 1080p/playlist.m3u8                                 â”‚   â”‚
â”‚   â”‚ #EXT-X-STREAM-INF:BANDWIDTH=2500000                 â”‚   â”‚
â”‚   â”‚ 720p/playlist.m3u8                                  â”‚   â”‚
â”‚   â”‚ ...                                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚   Player behavior:                                           â”‚
â”‚   1. Fetch manifest                                          â”‚
â”‚   2. Start with medium quality                              â”‚
â”‚   3. Monitor buffer and bandwidth                           â”‚
â”‚   4. Switch quality seamlessly                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Video Streaming Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Streaming Flow                              â”‚
â”‚                                                              â”‚
â”‚   1. User clicks play                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚  Player  â”‚â”€â”€â”€â”€â–ºâ”‚  API Server     â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚        â”‚                    â”‚                                â”‚
â”‚        â”‚           Get video metadata + CDN URLs            â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚        â”‚                                                     â”‚
â”‚   2. Fetch manifest from CDN                                â”‚
â”‚        â”‚                                                     â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                   â”‚    CDN Edge     â”‚                       â”‚
â”‚        â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚                       â”‚
â”‚    manifest.m3u8  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚        â”‚                                                     â”‚
â”‚   3. Fetch video segments                                   â”‚
â”‚        â”‚                                                     â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                    â”‚    CDN Edge     â”‚                      â”‚
â”‚        â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (cached)       â”‚                      â”‚
â”‚    segment_001.ts  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚        â”‚                                                     â”‚
â”‚   4. Continue fetching ahead of playback                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## A - API Design

### Upload Video

```
# Step 1: Initialize upload
POST /api/videos/upload
Authorization: Bearer {token}
{
    "title": "My Video",
    "description": "...",
    "visibility": "public"
}

Response:
{
    "video_id": "uuid-123",
    "upload_url": "https://s3.amazonaws.com/...",
    "expires_at": "..."
}

# Step 2: Upload to S3 (client-side)
PUT {upload_url}
Content-Type: video/mp4
Body: <binary video data>

# Step 3: Confirm upload
POST /api/videos/{video_id}/confirm
```

### Get Video

```
GET /api/videos/{video_id}

Response:
{
    "video_id": "uuid-123",
    "title": "My Video",
    "description": "...",
    "channel": {
        "id": "456",
        "name": "MyChannel",
        "subscriber_count": 100000
    },
    "duration": 600,
    "view_count": 1000000,
    "like_count": 50000,
    "upload_date": "2024-01-15T00:00:00Z",
    "streaming_url": "https://cdn.youtube.com/v/uuid-123/manifest.m3u8",
    "thumbnails": {
        "default": "https://cdn.youtube.com/t/uuid-123/default.jpg",
        "high": "https://cdn.youtube.com/t/uuid-123/high.jpg"
    }
}
```

### Search Videos

```
GET /api/search?q=cooking+tutorial&page=1&limit=20

Response:
{
    "results": [
        {
            "video_id": "...",
            "title": "...",
            "thumbnail": "...",
            "channel_name": "...",
            "view_count": 1000000,
            "duration": 600,
            "upload_date": "..."
        }
    ],
    "total_results": 1000,
    "next_page": 2
}
```

---

## D - Detailed Design (Continued)

### CDN Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CDN Architecture                          â”‚
â”‚                                                              â”‚
â”‚   Global Edge Locations:                                     â”‚
â”‚   â”œâ”€â”€ 200+ Points of Presence (POPs)                        â”‚
â”‚   â”œâ”€â”€ Each POP caches popular videos                        â”‚
â”‚   â””â”€â”€ User served from nearest POP                          â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    User                              â”‚   â”‚
â”‚   â”‚                      â”‚                               â”‚   â”‚
â”‚   â”‚                      â–¼                               â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚   â”‚   â”‚         Nearest Edge Server               â”‚     â”‚   â”‚
â”‚   â”‚   â”‚         (CDN POP)                         â”‚     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚   â”‚                    â”‚                                â”‚   â”‚
â”‚   â”‚           Cache Hit? â”€â”€â”€ Yes â”€â”€â–º Return video      â”‚   â”‚
â”‚   â”‚                â”‚                                    â”‚   â”‚
â”‚   â”‚               No                                    â”‚   â”‚
â”‚   â”‚                â”‚                                    â”‚   â”‚
â”‚   â”‚                â–¼                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚   â”‚   â”‚         Regional Cache                    â”‚    â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚   â”‚                    â”‚                               â”‚   â”‚
â”‚   â”‚               Cache Miss                           â”‚   â”‚
â”‚   â”‚                    â”‚                               â”‚   â”‚
â”‚   â”‚                    â–¼                               â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚              Origin (S3)                   â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚   Cache Strategy:                                            â”‚
â”‚   â”œâ”€â”€ Hot videos (new, trending): 90%+ cache hit           â”‚
â”‚   â”œâ”€â”€ Long tail: Lower hit rate, fetch from origin         â”‚
â”‚   â””â”€â”€ Predictive pre-caching for anticipated demand        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### View Counting

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              View Counting Architecture                      â”‚
â”‚                                                              â”‚
â”‚   Challenge: 600K views/second, accurate counting           â”‚
â”‚                                                              â”‚
â”‚   Solution: Async counting with deduplication               â”‚
â”‚                                                              â”‚
â”‚   1. User watches video                                      â”‚
â”‚   2. View event â†’ Kafka                                      â”‚
â”‚   3. Consumer deduplicates (user+video in window)           â”‚
â”‚   4. Increment counter (sharded)                            â”‚
â”‚   5. Periodic flush to database                             â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚  Player  â”‚â”€â”€â”€â”€â–ºâ”‚  Kafka  â”‚â”€â”€â”€â”€â–ºâ”‚ View Processor â”‚       â”‚
â”‚   â”‚  (event) â”‚     â”‚         â”‚     â”‚                â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                            â”‚                 â”‚
â”‚                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                                â–¼                       â–¼    â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                         â”‚   Redis   â”‚           â”‚ Database â”‚â”‚
â”‚                         â”‚ (counter) â”‚           â”‚ (batch)  â”‚â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                              â”‚
â”‚   Deduplication:                                             â”‚
â”‚   â”œâ”€â”€ Same user can't count twice in 30 seconds            â”‚
â”‚   â”œâ”€â”€ Bloom filter for efficiency                          â”‚
â”‚   â””â”€â”€ IP-based for non-logged-in users                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Video Recommendations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Recommendation System                           â”‚
â”‚                                                              â”‚
â”‚   Input signals:                                             â”‚
â”‚   â”œâ”€â”€ Watch history                                         â”‚
â”‚   â”œâ”€â”€ Likes, subscriptions                                  â”‚
â”‚   â”œâ”€â”€ Search history                                        â”‚
â”‚   â”œâ”€â”€ Demographics                                          â”‚
â”‚   â””â”€â”€ Current video context                                 â”‚
â”‚                                                              â”‚
â”‚   Approaches:                                                â”‚
â”‚                                                              â”‚
â”‚   1. Collaborative Filtering:                                â”‚
â”‚      "Users like you also watched..."                       â”‚
â”‚      User-video matrix â†’ Matrix factorization               â”‚
â”‚                                                              â”‚
â”‚   2. Content-Based:                                          â”‚
â”‚      "Similar to this video..."                             â”‚
â”‚      Video features (title, tags, description)              â”‚
â”‚                                                              â”‚
â”‚   3. Deep Learning (YouTube's approach):                    â”‚
â”‚      Two-stage: Candidate generation â†’ Ranking              â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  Millions of videos                                â”‚    â”‚
â”‚   â”‚         â”‚                                          â”‚    â”‚
â”‚   â”‚         â–¼ (Candidate Generation - fast)            â”‚    â”‚
â”‚   â”‚  Hundreds of candidates                            â”‚    â”‚
â”‚   â”‚         â”‚                                          â”‚    â”‚
â”‚   â”‚         â–¼ (Ranking Model - precise)                â”‚    â”‚
â”‚   â”‚  Top 20 recommendations                            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## E - Evaluation

### Bottlenecks

```
1. Upload processing backlog
   â†’ Scale transcoding workers
   â†’ Priority queue for premium creators

2. CDN cache misses for long tail
   â†’ Tiered caching
   â†’ Predictive pre-caching

3. View counting accuracy
   â†’ Accept slight delay (minutes)
   â†’ Batch processing

4. Search latency
   â†’ Elasticsearch cluster
   â†’ Search result caching
```

### Cost Optimization

```
Storage Tiers:
â”œâ”€â”€ Hot (SSD): Recent videos, frequently watched
â”œâ”€â”€ Warm (HDD): Older videos, moderate access
â”œâ”€â”€ Cold (Glacier): Very old, rarely watched

Compression:
â”œâ”€â”€ Modern codecs (VP9, AV1) for popular videos
â”œâ”€â”€ Aggressive compression for low resolutions
â””â”€â”€ Audio-only option for music videos

CDN:
â”œâ”€â”€ Negotiate bandwidth pricing
â”œâ”€â”€ Origin shield to reduce fetches
â”œâ”€â”€ Compress during low traffic
```

---

## D - Distinctive Features

### Live Streaming

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Live Streaming Pipeline                      â”‚
â”‚                                                              â”‚
â”‚   Creator â†’ RTMP â†’ Ingest Server â†’ Transcode â†’ CDN â†’ Users  â”‚
â”‚                                                              â”‚
â”‚   1. Creator streams via RTMP                               â”‚
â”‚   2. Ingest server receives stream                          â”‚
â”‚   3. Real-time transcoding to HLS segments                  â”‚
â”‚   4. Push to CDN edge servers                               â”‚
â”‚   5. Users watch with ~5-30 second delay                    â”‚
â”‚                                                              â”‚
â”‚   Additional:                                                â”‚
â”‚   â”œâ”€â”€ DVR functionality (rewind live)                       â”‚
â”‚   â”œâ”€â”€ Live chat (WebSocket)                                 â”‚
â”‚   â”œâ”€â”€ Super Chat (donations)                                â”‚
â”‚   â””â”€â”€ Auto-archive after stream ends                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Copyright Detection (Content ID)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Copyright Detection                            â”‚
â”‚                                                              â”‚
â”‚   During upload processing:                                  â”‚
â”‚                                                              â”‚
â”‚   1. Extract audio fingerprint                              â”‚
â”‚   2. Compare against reference database                     â”‚
â”‚   3. If match found:                                        â”‚
â”‚      â”œâ”€â”€ Block upload                                       â”‚
â”‚      â”œâ”€â”€ Monetize for copyright holder                     â”‚
â”‚      â””â”€â”€ Allow (if license exists)                          â”‚
â”‚                                                              â”‚
â”‚   Technology:                                                â”‚
â”‚   â”œâ”€â”€ Audio fingerprinting (Shazam-like)                   â”‚
â”‚   â”œâ”€â”€ Video frame hashing                                   â”‚
â”‚   â””â”€â”€ ML for derivative content detection                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Summary

```
Key Components:
â”œâ”€â”€ Upload Service: Receive, store, trigger processing
â”œâ”€â”€ Transcoding: Convert to multiple formats/resolutions
â”œâ”€â”€ CDN: Global video delivery
â”œâ”€â”€ Streaming: HLS/DASH adaptive bitrate
â”œâ”€â”€ Search: Elasticsearch
â”œâ”€â”€ Recommendations: ML-based ranking

Key Decisions:
â”œâ”€â”€ Direct upload to S3 (bypass application servers)
â”œâ”€â”€ Async transcoding pipeline
â”œâ”€â”€ Aggressive CDN caching
â”œâ”€â”€ Sharded view counters
â”œâ”€â”€ Adaptive bitrate streaming

Scale:
â”œâ”€â”€ 50+ PB storage
â”œâ”€â”€ 600K views/second
â”œâ”€â”€ 200+ CDN edge locations
â”œâ”€â”€ Seconds to start playback
```
